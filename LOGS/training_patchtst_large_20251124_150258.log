================================================================================
PATCHTST HEART RATE PREDICTION - TRAINING
================================================================================

Configuration:
  Model: PatchTST
  Epochs: 50
  Batch size: 64
  Learning rate: 0.0001
  Device: cuda

Architecture:
  Patch length: 16
  Stride: 8
  Model dimension: 256
  Attention heads: 16
  Hidden layers: 6
  FFN dimension: 512
  Dropout: 0.1

Loading HuggingFace dataset from DATA/processed_hf...
✓ Loaded 13855 train samples
✓ Loaded 3539 validation samples
✓ Loaded 3581 test samples

Dataset info:
  Train samples: 13855
  Val samples: 3539
  Test samples: 3581
  Sequence length: 500

Initializing PatchTST model...
✓ Model initialized
  Total parameters: 3,561,592
  Trainable parameters: 3,545,976

================================================================================
STARTING TRAINING
================================================================================

Epoch 1/50
--------------------------------------------------------------------------------
Train Loss: 15920.6338
Val Loss:   6128.1348
Val MAE:    68.41 BPM
LR:         0.000100
✓ New best model! (Val Loss: 6128.1348)

Epoch 2/50
--------------------------------------------------------------------------------
Train Loss: 7172.6185
Val Loss:   3718.1654
Val MAE:    41.43 BPM
LR:         0.000100
✓ New best model! (Val Loss: 3718.1654)

Epoch 3/50
--------------------------------------------------------------------------------
Train Loss: 5883.1121
Val Loss:   3156.3820
Val MAE:    41.88 BPM
LR:         0.000100
✓ New best model! (Val Loss: 3156.3820)

Epoch 4/50
--------------------------------------------------------------------------------
Train Loss: 5306.8103
Val Loss:   3095.0372
Val MAE:    39.94 BPM
LR:         0.000100
✓ New best model! (Val Loss: 3095.0372)

Epoch 5/50
--------------------------------------------------------------------------------
Train Loss: 4831.9882
Val Loss:   2945.0487
Val MAE:    39.76 BPM
LR:         0.000100
✓ New best model! (Val Loss: 2945.0487)

Epoch 6/50
--------------------------------------------------------------------------------
Train Loss: 4536.0579
Val Loss:   2675.7100
Val MAE:    40.63 BPM
LR:         0.000100
✓ New best model! (Val Loss: 2675.7100)

Epoch 7/50
--------------------------------------------------------------------------------
Train Loss: 4151.3212
Val Loss:   2613.6595
Val MAE:    38.82 BPM
LR:         0.000100
✓ New best model! (Val Loss: 2613.6595)

Epoch 8/50
--------------------------------------------------------------------------------
Train Loss: 3967.3357
Val Loss:   2726.6372
Val MAE:    40.52 BPM
LR:         0.000100
Patience: 1/10

Epoch 9/50
--------------------------------------------------------------------------------
Train Loss: 3848.9087
Val Loss:   2647.3626
Val MAE:    39.48 BPM
LR:         0.000100
Patience: 2/10

Epoch 10/50
--------------------------------------------------------------------------------
Train Loss: 3709.6499
Val Loss:   2694.7082
Val MAE:    39.10 BPM
LR:         0.000100
Patience: 3/10

Epoch 11/50
--------------------------------------------------------------------------------
Train Loss: 3597.4592
Val Loss:   2929.2993
Val MAE:    39.21 BPM
LR:         0.000100
Patience: 4/10

Epoch 12/50
--------------------------------------------------------------------------------
Train Loss: 3575.9552
Val Loss:   2950.5491
Val MAE:    39.33 BPM
LR:         0.000100
Patience: 5/10

Epoch 13/50
--------------------------------------------------------------------------------
Train Loss: 3394.0094
Val Loss:   2715.7599
Val MAE:    38.61 BPM
LR:         0.000100
Patience: 6/10

Epoch 14/50
--------------------------------------------------------------------------------
Train Loss: 3492.4491
Val Loss:   2641.7047
Val MAE:    39.44 BPM
LR:         0.000050
Patience: 7/10

Epoch 15/50
--------------------------------------------------------------------------------
Train Loss: 3451.7892
Val Loss:   2789.2696
Val MAE:    39.67 BPM
LR:         0.000050
Patience: 8/10

Epoch 16/50
--------------------------------------------------------------------------------
Train Loss: 3492.0520
Val Loss:   2696.0452
Val MAE:    38.72 BPM
LR:         0.000050
Patience: 9/10

Epoch 17/50
--------------------------------------------------------------------------------
Train Loss: 3345.1264
Val Loss:   2632.0763
Val MAE:    40.03 BPM
LR:         0.000050
Patience: 10/10

Early stopping triggered after 17 epochs

================================================================================
TRAINING COMPLETE
================================================================================
Best Val Loss: 2613.6595

================================================================================
EVALUATING ON TEST SET
================================================================================

Test Results:
  Loss: 4347.3907
  MAE:  41.04 BPM
  RMSE: 56.24 BPM

✓ Training curves saved to: checkpoints/patchtst_bs64_lr0.0001_e50_d256_l6_p16_training_curves.png

✓ Checkpoint saved:
  Model:    checkpoints/patchtst_bs64_lr0.0001_e50_d256_l6_p16_model.pt
  History:  checkpoints/patchtst_bs64_lr0.0001_e50_d256_l6_p16_history.json
  Metrics:  checkpoints/patchtst_bs64_lr0.0001_e50_d256_l6_p16_metrics.json
  Plot:     checkpoints/patchtst_bs64_lr0.0001_e50_d256_l6_p16_training_curves.png

================================================================================
TRAINING PIPELINE COMPLETE!
================================================================================

Final Test Results:
  MAE:  41.04 BPM
  RMSE: 56.24 BPM 

⚠ MAE > 10 BPM - Consider tuning hyperparameters
