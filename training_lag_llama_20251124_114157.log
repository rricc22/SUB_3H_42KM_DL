nohup: ignoring input

GPU Configuration:
  Device: NVIDIA GeForce GTX 1060 6GB
  Memory allocated: 0.00 MB
  Memory reserved: 0.00 MB
  cuDNN enabled: False (disabled for compatibility)
  Using PyTorch native LSTM implementation

================================================================================
HEART RATE PREDICTION - MODEL TRAINING
================================================================================
Model: lag_llama
Device: cuda

Loading data from DATA/processed...
✓ Data loaded:
  Train: 13855 samples
  Val:   3539 samples
  Test:  3581 samples

Creating lag_llama model...
✓ Model created:
  Total parameters: 810,817

================================================================================
TRAINING LAG_LLAMA MODEL
================================================================================
Device: cuda
Epochs: 30
Batch size: 256
Learning rate: 0.0001
Early stopping patience: 5
================================================================================

/home/riccardo/anaconda3/envs/ai-general/lib/python3.11/site-packages/torch/nn/modules/transformer.py:502: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. (Triggered internally at ../aten/src/ATen/NestedTensorImpl.cpp:178.)
  output = torch._nested_tensor_from_mask(
Epoch [  1/30] | Train Loss: 22208.2730 | Train MAE: 147.83 BPM | Val Loss: 21834.2628 | Val MAE: 146.52 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 146.52 BPM)
Epoch [  2/30] | Train Loss: 21600.3752 | Train MAE: 145.76 BPM | Val Loss: 21406.0614 | Val MAE: 145.04 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 145.04 BPM)
Epoch [  3/30] | Train Loss: 20990.8473 | Train MAE: 143.66 BPM | Val Loss: 20857.8712 | Val MAE: 143.12 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 143.12 BPM)
Epoch [  4/30] | Train Loss: 20260.5959 | Train MAE: 141.09 BPM | Val Loss: 20184.4918 | Val MAE: 140.71 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 140.71 BPM)
Epoch [  5/30] | Train Loss: 19368.2741 | Train MAE: 137.89 BPM | Val Loss: 19391.2120 | Val MAE: 137.81 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 137.81 BPM)
Epoch [  6/30] | Train Loss: 18295.5626 | Train MAE: 133.93 BPM | Val Loss: 18485.4284 | Val MAE: 134.40 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 134.40 BPM)
Epoch [  7/30] | Train Loss: 17158.8541 | Train MAE: 129.62 BPM | Val Loss: 17481.2224 | Val MAE: 130.49 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 130.49 BPM)
Epoch [  8/30] | Train Loss: 15863.0036 | Train MAE: 124.52 BPM | Val Loss: 16394.6680 | Val MAE: 126.09 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 126.09 BPM)
Epoch [  9/30] | Train Loss: 14500.3753 | Train MAE: 118.91 BPM | Val Loss: 15247.6699 | Val MAE: 121.22 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 121.22 BPM)
Epoch [ 10/30] | Train Loss: 13052.3873 | Train MAE: 112.63 BPM | Val Loss: 14063.5984 | Val MAE: 115.91 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 115.91 BPM)
Epoch [ 11/30] | Train Loss: 11618.5810 | Train MAE: 106.07 BPM | Val Loss: 12870.7815 | Val MAE: 110.22 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 110.22 BPM)
Epoch [ 12/30] | Train Loss: 10149.5961 | Train MAE: 98.90 BPM | Val Loss: 11693.3009 | Val MAE: 104.19 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 104.19 BPM)
Epoch [ 13/30] | Train Loss: 8732.9107 | Train MAE: 91.43 BPM | Val Loss: 10559.6313 | Val MAE: 97.91 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 97.91 BPM)
Epoch [ 14/30] | Train Loss: 7383.1175 | Train MAE: 83.71 BPM | Val Loss: 9493.0964 | Val MAE: 91.46 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 91.46 BPM)
Epoch [ 15/30] | Train Loss: 6122.7259 | Train MAE: 75.79 BPM | Val Loss: 8514.9608 | Val MAE: 84.92 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 84.92 BPM)
Epoch [ 16/30] | Train Loss: 4976.2971 | Train MAE: 67.81 BPM | Val Loss: 7643.4173 | Val MAE: 78.44 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 78.44 BPM)
Epoch [ 17/30] | Train Loss: 3973.4906 | Train MAE: 60.02 BPM | Val Loss: 6889.2171 | Val MAE: 72.14 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 72.14 BPM)
Epoch [ 18/30] | Train Loss: 3113.3825 | Train MAE: 52.44 BPM | Val Loss: 6256.2598 | Val MAE: 66.15 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 66.15 BPM)
Epoch [ 19/30] | Train Loss: 2408.2452 | Train MAE: 45.39 BPM | Val Loss: 5744.0241 | Val MAE: 60.58 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 60.58 BPM)
Epoch [ 20/30] | Train Loss: 1844.8407 | Train MAE: 38.93 BPM | Val Loss: 5343.0932 | Val MAE: 55.53 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 55.53 BPM)
Epoch [ 21/30] | Train Loss: 1408.2907 | Train MAE: 33.15 BPM | Val Loss: 5040.8331 | Val MAE: 51.15 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 51.15 BPM)
Epoch [ 22/30] | Train Loss: 1086.1210 | Train MAE: 28.32 BPM | Val Loss: 4822.6955 | Val MAE: 47.56 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 47.56 BPM)
Epoch [ 23/30] | Train Loss: 855.2386 | Train MAE: 24.42 BPM | Val Loss: 4671.4357 | Val MAE: 44.76 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 44.76 BPM)
Epoch [ 24/30] | Train Loss: 701.7322 | Train MAE: 21.61 BPM | Val Loss: 4571.5340 | Val MAE: 42.71 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 42.71 BPM)
Epoch [ 25/30] | Train Loss: 602.3548 | Train MAE: 19.71 BPM | Val Loss: 4507.3876 | Val MAE: 41.25 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 41.25 BPM)
Epoch [ 26/30] | Train Loss: 536.7788 | Train MAE: 18.39 BPM | Val Loss: 4468.5343 | Val MAE: 40.28 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 40.28 BPM)
Epoch [ 27/30] | Train Loss: 496.3333 | Train MAE: 17.56 BPM | Val Loss: 4445.7256 | Val MAE: 39.66 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 39.66 BPM)
Epoch [ 28/30] | Train Loss: 474.4746 | Train MAE: 17.12 BPM | Val Loss: 4433.0182 | Val MAE: 39.27 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 39.27 BPM)
Epoch [ 29/30] | Train Loss: 462.2750 | Train MAE: 16.85 BPM | Val Loss: 4426.2387 | Val MAE: 39.05 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 39.05 BPM)
Epoch [ 30/30] | Train Loss: 454.2637 | Train MAE: 16.68 BPM | Val Loss: 4422.8789 | Val MAE: 38.92 BPM | LR: 0.000100
  ✓ New best model! (Val MAE: 38.92 BPM)

================================================================================
TRAINING COMPLETE
================================================================================
Best Val MAE: 38.92 BPM

================================================================================
EVALUATING ON TEST SET
================================================================================
Test Metrics:
  MSE:  4165.8413
  MAE:  37.90 BPM
  RMSE: 64.54 BPM
  R²:   -9.3470

✓ Checkpoint saved to: checkpoints/lag_llama_best.pt
✓ Training curves saved to: checkpoints/lag_llama_training_curves.png

================================================================================
✓ TRAINING PIPELINE COMPLETE!
================================================================================

